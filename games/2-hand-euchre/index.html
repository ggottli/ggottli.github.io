<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Two-Handed Euchre</title>
        <link
            href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Source+Sans+3:wght@400;500;600&display=swap"
            rel="stylesheet"
        />
        <style>
            :root {
                --felt-dark: #0a1f12;
                --felt-main: #1a4d2e;
                --felt-light: #2d6b44;
                --gold: #d4af37;
                --gold-light: #f4d03f;
                --gold-dark: #b8860b;
                --card-shadow:
                    0 4px 12px rgba(0, 0, 0, 0.4), 0 2px 4px rgba(0, 0, 0, 0.3);
                --card-hover-shadow:
                    0 12px 28px rgba(212, 175, 55, 0.3),
                    0 8px 16px rgba(0, 0, 0, 0.4);
                --panel-bg: rgba(0, 0, 0, 0.75);
                --panel-border: rgba(212, 175, 55, 0.3);
            }

            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            body {
                font-family: "Source Sans 3", sans-serif;
                background: var(--felt-dark);
                color: #f0f0f0;
                min-height: 100vh;
                overflow-x: hidden;
            }

            /* Felt table background */
            .table-surface {
                position: fixed;
                inset: 0;
                background:
                    radial-gradient(
                        ellipse 120% 100% at 50% 100%,
                        var(--felt-light) 0%,
                        transparent 50%
                    ),
                    radial-gradient(
                        ellipse 120% 100% at 50% 0%,
                        var(--felt-light) 0%,
                        transparent 50%
                    ),
                    radial-gradient(
                        ellipse at center,
                        var(--felt-main) 0%,
                        var(--felt-dark) 100%
                    );
                z-index: 0;
            }

            .table-surface::before {
                content: "";
                position: absolute;
                inset: 0;
                background: url("data:image/svg+xml,%3Csvg viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
                opacity: 0.03;
                pointer-events: none;
            }

            .game-wrapper {
                position: relative;
                z-index: 1;
                max-width: 1200px;
                margin: 0 auto;
                padding: 1rem;
                min-height: 100vh;
                display: flex;
                flex-direction: column;
            }

            /* Header */
            .header {
                background: var(--panel-bg);
                backdrop-filter: blur(12px);
                border: 1px solid var(--panel-border);
                border-radius: 16px;
                padding: 1rem 1.5rem;
                margin-bottom: 1rem;
                display: flex;
                justify-content: space-between;
                align-items: center;
                flex-wrap: wrap;
                gap: 1rem;
            }

            .title-section {
                display: flex;
                align-items: center;
                gap: 1rem;
            }

            h1 {
                font-family: "Playfair Display", serif;
                font-size: 1.5rem;
                font-weight: 600;
                color: var(--gold);
                letter-spacing: 0.05em;
            }

            .controls {
                display: flex;
                gap: 0.5rem;
            }

            .btn {
                font-family: "Source Sans 3", sans-serif;
                font-size: 0.875rem;
                font-weight: 500;
                padding: 0.5rem 1rem;
                border: 1px solid var(--gold-dark);
                border-radius: 8px;
                background: linear-gradient(
                    135deg,
                    rgba(212, 175, 55, 0.2) 0%,
                    rgba(184, 134, 11, 0.1) 100%
                );
                color: var(--gold-light);
                cursor: pointer;
                transition: all 0.2s ease;
            }

            .btn:hover {
                background: linear-gradient(
                    135deg,
                    rgba(212, 175, 55, 0.4) 0%,
                    rgba(184, 134, 11, 0.2) 100%
                );
                transform: translateY(-1px);
            }

            .btn-primary {
                background: linear-gradient(
                    135deg,
                    var(--gold) 0%,
                    var(--gold-dark) 100%
                );
                color: #000;
                border: none;
                font-weight: 600;
            }

            .btn-primary:hover {
                background: linear-gradient(
                    135deg,
                    var(--gold-light) 0%,
                    var(--gold) 100%
                );
            }

            select {
                font-family: "Source Sans 3", sans-serif;
                font-size: 0.875rem;
                padding: 0.5rem 0.75rem;
                border: 1px solid var(--gold-dark);
                border-radius: 8px;
                background: rgba(0, 0, 0, 0.5);
                color: var(--gold-light);
                cursor: pointer;
            }

            .score-section {
                display: flex;
                align-items: center;
                gap: 2rem;
            }

            .trump-display {
                text-align: center;
            }

            .trump-label {
                font-size: 0.75rem;
                text-transform: uppercase;
                letter-spacing: 0.1em;
                color: rgba(255, 255, 255, 0.6);
                margin-bottom: 0.25rem;
            }

            .trump-suit {
                font-size: 2rem;
                font-weight: 700;
                color: var(--gold);
                line-height: 1;
            }

            .trump-suit.red {
                color: #e74c3c;
            }
            .trump-suit.black {
                color: #ecf0f1;
            }

            .scores {
                display: flex;
                gap: 1.5rem;
            }

            .score-box {
                text-align: center;
                min-width: 60px;
            }

            .score-box .label {
                font-size: 0.75rem;
                text-transform: uppercase;
                letter-spacing: 0.1em;
                color: rgba(255, 255, 255, 0.6);
                margin-bottom: 0.25rem;
            }

            .score-box .value {
                font-family: "Playfair Display", serif;
                font-size: 1.75rem;
                font-weight: 700;
                color: var(--gold);
            }

            /* Game Area */
            .game-area {
                flex: 1;
                display: flex;
                flex-direction: column;
                gap: 0.75rem;
            }

            .player-zone {
                background: var(--panel-bg);
                backdrop-filter: blur(8px);
                border: 1px solid var(--panel-border);
                border-radius: 16px;
                padding: 1rem;
            }

            .player-zone.active {
                border-color: var(--gold);
                box-shadow: 0 0 20px rgba(212, 175, 55, 0.2);
            }

            .zone-header {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 0.75rem;
            }

            .player-name {
                font-family: "Playfair Display", serif;
                font-size: 1.1rem;
                font-weight: 600;
                color: var(--gold);
            }

            .player-name.dealer::after {
                content: " (Dealer)";
                font-size: 0.75rem;
                color: rgba(255, 255, 255, 0.5);
                font-weight: 400;
            }

            .player-name.caller::after {
                content: " ★";
                color: var(--gold-light);
            }

            .trick-badge {
                background: linear-gradient(
                    135deg,
                    var(--gold) 0%,
                    var(--gold-dark) 100%
                );
                color: #000;
                padding: 0.25rem 0.75rem;
                border-radius: 20px;
                font-size: 0.875rem;
                font-weight: 600;
            }

            .cards-row {
                display: flex;
                justify-content: center;
                gap: 0.5rem;
                flex-wrap: wrap;
                min-height: 90px;
            }

            .table-slots {
                display: flex;
                justify-content: center;
                gap: 0.5rem;
                margin-bottom: 0.5rem;
            }

            .table-slot {
                position: relative;
                width: 60px;
                height: 84px;
            }

            @media (min-width: 768px) {
                .table-slot {
                    width: 70px;
                    height: 98px;
                }
            }

            /* Cards */
            .card {
                width: 60px;
                height: 84px;
                border-radius: 8px;
                background: linear-gradient(145deg, #fff 0%, #f5f5f5 100%);
                border: 2px solid #ddd;
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
                font-weight: 700;
                box-shadow: var(--card-shadow);
                transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
                user-select: none;
                position: relative;
            }

            @media (min-width: 768px) {
                .card {
                    width: 70px;
                    height: 98px;
                }
            }

            .card.red {
                color: #c0392b;
            }
            .card.black {
                color: #2c3e50;
            }

            .card-rank {
                font-size: 1.25rem;
                line-height: 1;
            }

            .card-suit {
                font-size: 1rem;
                margin-top: 2px;
            }

            @media (min-width: 768px) {
                .card-rank {
                    font-size: 1.5rem;
                }
                .card-suit {
                    font-size: 1.2rem;
                }
            }

            .card.playable {
                cursor: pointer;
                border-color: var(--gold);
            }

            .card.playable:hover {
                transform: translateY(-12px) scale(1.05);
                box-shadow: var(--card-hover-shadow);
                z-index: 10;
            }

            .card.face-down {
                background: linear-gradient(145deg, #1a1a2e 0%, #16213e 100%);
                border-color: var(--gold-dark);
            }

            .card.face-down::before {
                content: "";
                position: absolute;
                inset: 6px;
                border: 1px solid rgba(212, 175, 55, 0.3);
                border-radius: 4px;
                background: repeating-linear-gradient(
                    45deg,
                    transparent,
                    transparent 4px,
                    rgba(212, 175, 55, 0.1) 4px,
                    rgba(212, 175, 55, 0.1) 8px
                );
            }

            .card.stacked {
                position: absolute;
                top: 0;
                left: 0;
            }

            .card.stacked.top {
                top: -3px;
                left: -3px;
            }

            /* Trick Area */
            .trick-zone {
                background: radial-gradient(
                    ellipse at center,
                    rgba(212, 175, 55, 0.08) 0%,
                    transparent 70%
                );
                border: 2px dashed rgba(212, 175, 55, 0.3);
                border-radius: 20px;
                padding: 1.5rem;
                display: flex;
                justify-content: center;
                align-items: center;
                gap: 3rem;
                min-height: 120px;
            }

            .trick-card-wrapper {
                position: relative;
            }

            .trick-card-label {
                position: absolute;
                bottom: -20px;
                left: 50%;
                transform: translateX(-50%);
                font-size: 0.75rem;
                color: rgba(255, 255, 255, 0.5);
                white-space: nowrap;
            }

            .trick-card {
                opacity: 0;
                transform: scale(0.8);
                transition: all 0.3s ease;
                visibility: hidden;
            }

            .trick-card.visible {
                opacity: 1;
                transform: scale(1);
                visibility: visible;
            }

            .trick-card.winner {
                box-shadow:
                    0 0 30px rgba(212, 175, 55, 0.6),
                    var(--card-shadow);
            }

            /* Modal */
            .modal-overlay {
                position: fixed;
                inset: 0;
                background: rgba(0, 0, 0, 0.4);
                z-index: 100;
                display: flex;
                justify-content: center;
                align-items: flex-start;
                padding: 2rem 1rem;
                opacity: 0;
                pointer-events: none;
                transition: opacity 0.3s ease;
            }

            .modal-overlay.visible {
                opacity: 1;
                pointer-events: auto;
            }

            .modal {
                background: linear-gradient(
                    145deg,
                    rgba(26, 77, 46, 0.98) 0%,
                    rgba(10, 31, 18, 0.98) 100%
                );
                border: 2px solid var(--gold);
                border-radius: 20px;
                padding: 2rem;
                max-width: 480px;
                width: 100%;
                text-align: center;
                transform: scale(0.9);
                transition: transform 0.3s ease;
            }

            .modal-overlay.visible .modal {
                transform: scale(1);
            }

            .modal h2 {
                font-family: "Playfair Display", serif;
                font-size: 1.75rem;
                color: var(--gold);
                margin-bottom: 1rem;
            }

            .modal-content {
                color: rgba(255, 255, 255, 0.9);
                margin-bottom: 1.5rem;
                line-height: 1.6;
            }

            .modal-buttons {
                display: flex;
                justify-content: center;
                flex-wrap: wrap;
                gap: 0.75rem;
            }

            .suit-btn {
                width: 60px;
                height: 60px;
                border-radius: 12px;
                font-size: 2rem;
                border: 2px solid transparent;
                cursor: pointer;
                transition: all 0.2s ease;
            }

            .suit-btn.hearts,
            .suit-btn.diamonds {
                background: linear-gradient(145deg, #e74c3c 0%, #c0392b 100%);
                color: #fff;
            }

            .suit-btn.spades,
            .suit-btn.clubs {
                background: linear-gradient(145deg, #34495e 0%, #2c3e50 100%);
                color: #fff;
            }

            .suit-btn:hover {
                transform: scale(1.1);
                border-color: var(--gold);
            }

            /* Animations */
            @keyframes cardEnter {
                0% {
                    opacity: 0;
                    transform: scale(0.5) translateY(-30px) rotate(10deg);
                }
                60% {
                    transform: scale(1.1) translateY(-5px) rotate(-3deg);
                }
                100% {
                    opacity: 1;
                    transform: scale(1) translateY(0) rotate(0);
                }
            }

            @keyframes cardExit {
                0% {
                    opacity: 1;
                    transform: scale(1) translateY(0);
                }
                100% {
                    opacity: 0;
                    transform: scale(0.3)
                        translateY(var(--exit-direction, -100px));
                }
            }

            @keyframes pulse {
                0%,
                100% {
                    box-shadow: 0 0 20px rgba(212, 175, 55, 0.2);
                }
                50% {
                    box-shadow: 0 0 30px rgba(212, 175, 55, 0.4);
                }
            }

            .card-enter {
                animation: cardEnter 0.4s ease-out forwards;
            }

            .card-exit {
                animation: cardExit 0.5s ease-in forwards;
            }

            .pulse {
                animation: pulse 1.5s ease-in-out infinite;
            }

            /* Status Message */
            .status-bar {
                text-align: center;
                padding: 0.5rem;
                font-size: 0.9rem;
                color: rgba(255, 255, 255, 0.7);
                min-height: 2rem;
            }

            .status-bar .highlight {
                color: var(--gold);
                font-weight: 600;
            }

            /* Hand history panel */
            .history-toggle {
                position: fixed;
                bottom: 1rem;
                right: 1rem;
                z-index: 50;
            }

            .history-panel {
                position: fixed;
                bottom: 4rem;
                right: 1rem;
                width: 280px;
                max-height: 300px;
                background: var(--panel-bg);
                backdrop-filter: blur(12px);
                border: 1px solid var(--panel-border);
                border-radius: 12px;
                padding: 1rem;
                overflow-y: auto;
                z-index: 49;
                opacity: 0;
                transform: translateY(10px);
                pointer-events: none;
                transition: all 0.3s ease;
            }

            .history-panel.visible {
                opacity: 1;
                transform: translateY(0);
                pointer-events: auto;
            }

            .history-panel h3 {
                font-family: "Playfair Display", serif;
                color: var(--gold);
                margin-bottom: 0.75rem;
                font-size: 1rem;
            }

            .history-item {
                font-size: 0.8rem;
                padding: 0.25rem 0;
                border-bottom: 1px solid rgba(255, 255, 255, 0.1);
                color: rgba(255, 255, 255, 0.7);
            }

            .history-item:last-child {
                border-bottom: none;
            }

            .history-item .winner {
                color: var(--gold);
            }

            /* Thinking indicator */
            .thinking {
                display: inline-flex;
                gap: 4px;
                margin-left: 8px;
            }

            .thinking span {
                width: 6px;
                height: 6px;
                background: var(--gold);
                border-radius: 50%;
                animation: bounce 1.4s infinite ease-in-out both;
            }

            .thinking span:nth-child(1) {
                animation-delay: -0.32s;
            }
            .thinking span:nth-child(2) {
                animation-delay: -0.16s;
            }

            @keyframes bounce {
                0%,
                80%,
                100% {
                    transform: scale(0);
                }
                40% {
                    transform: scale(1);
                }
            }

            /* Rules modal styling */
            .rules-content {
                text-align: left;
                font-size: 0.9rem;
                max-height: 60vh;
                overflow-y: auto;
            }

            .rules-content h4 {
                color: var(--gold);
                margin: 1rem 0 0.5rem;
                font-size: 1rem;
            }

            .rules-content h4:first-child {
                margin-top: 0;
            }

            .rules-content p,
            .rules-content ul {
                margin-bottom: 0.5rem;
                color: rgba(255, 255, 255, 0.85);
            }

            .rules-content ul {
                padding-left: 1.25rem;
            }

            .rules-content li {
                margin-bottom: 0.25rem;
            }
        </style>
    </head>
    <body>
        <div class="table-surface"></div>

        <div class="game-wrapper">
            <header class="header">
                <div class="title-section">
                    <h1>Two-Handed Euchre</h1>
                    <div class="controls">
                        <button class="btn" id="rules-btn">Rules</button>
                        <select id="difficulty">
                            <option value="easy">Easy</option>
                            <option value="medium" selected>Medium</option>
                            <option value="hard">Hard</option>
                        </select>
                    </div>
                </div>

                <div class="score-section">
                    <div class="trump-display">
                        <div class="trump-label">Trump</div>
                        <div class="trump-suit" id="trump-indicator">—</div>
                    </div>
                    <div class="scores">
                        <div class="score-box">
                            <div class="label">You</div>
                            <div class="value" id="player-score">0</div>
                        </div>
                        <div class="score-box">
                            <div class="label">Bot</div>
                            <div class="value" id="bot-score">0</div>
                        </div>
                    </div>
                </div>
            </header>

            <main class="game-area">
                <!-- Bot Zone -->
                <section class="player-zone" id="bot-zone">
                    <div class="zone-header">
                        <div class="player-name" id="bot-name">Opponent</div>
                        <div class="trick-badge">
                            <span id="bot-tricks">0</span> tricks
                        </div>
                    </div>
                    <div class="table-slots" id="bot-table"></div>
                    <div class="cards-row" id="bot-hand"></div>
                </section>

                <!-- Status -->
                <div class="status-bar" id="status"></div>

                <!-- Trick Zone -->
                <section class="trick-zone">
                    <div class="trick-card-wrapper">
                        <div class="card trick-card" id="bot-played"></div>
                        <div class="trick-card-label">Opponent</div>
                    </div>
                    <div class="trick-card-wrapper">
                        <div class="card trick-card" id="player-played"></div>
                        <div class="trick-card-label">You</div>
                    </div>
                </section>

                <!-- Player Zone -->
                <section class="player-zone" id="player-zone">
                    <div class="zone-header">
                        <div class="player-name" id="player-name">You</div>
                        <div class="trick-badge">
                            <span id="player-tricks">0</span> tricks
                        </div>
                    </div>
                    <div class="table-slots" id="player-table"></div>
                    <div class="cards-row" id="player-hand"></div>
                </section>
            </main>
        </div>

        <!-- History Panel -->
        <div class="history-panel" id="history-panel">
            <h3>Trick History</h3>
            <div id="history-list"></div>
        </div>
        <button class="btn history-toggle" id="history-toggle">History</button>

        <!-- Modal -->
        <div class="modal-overlay" id="modal">
            <div class="modal">
                <h2 id="modal-title"></h2>
                <div class="modal-content" id="modal-content"></div>
                <div class="modal-buttons" id="modal-buttons"></div>
            </div>
        </div>

        <script>
            // ============================================
            // GAME CONSTANTS
            // ============================================
            const SUITS = { S: "♠", H: "♥", D: "♦", C: "♣" };
            const SUIT_COLORS = { S: "black", H: "red", D: "red", C: "black" };
            const SAME_COLOR = { S: "C", C: "S", H: "D", D: "H" };
            const RANKS = ["9", "10", "J", "Q", "K", "A"];
            const RANK_ORDER = { 9: 0, 10: 1, J: 2, Q: 3, K: 4, A: 5 };
            const WINNING_SCORE = 31;

            // ============================================
            // GAME STATE
            // ============================================
            const state = {
                deck: [],
                playerHand: {
                    inHand: [],
                    tableUp: [null, null, null, null],
                    tableDown: [null, null, null, null],
                },
                botHand: {
                    inHand: [],
                    tableUp: [null, null, null, null],
                    tableDown: [null, null, null, null],
                },
                trump: null,
                trumpCaller: null,
                playerScore: 0,
                botScore: 0,
                playerTricks: 0,
                botTricks: 0,
                isPlayerDealer: false,
                currentTurn: null,
                leadCard: null,
                playedCards: [],
                trickHistory: [],
                gamePhase: "idle", // idle, dealing, trumpSelect, playing, trickEval, handEnd, gameEnd
                difficulty: "medium",
                cardsPlayedThisHand: [], // For bot AI memory
            };

            // ============================================
            // DOM ELEMENTS
            // ============================================
            const els = {
                playerScore: document.getElementById("player-score"),
                botScore: document.getElementById("bot-score"),
                playerTricks: document.getElementById("player-tricks"),
                botTricks: document.getElementById("bot-tricks"),
                trumpIndicator: document.getElementById("trump-indicator"),
                playerTable: document.getElementById("player-table"),
                botTable: document.getElementById("bot-table"),
                playerHand: document.getElementById("player-hand"),
                botHand: document.getElementById("bot-hand"),
                playerPlayed: document.getElementById("player-played"),
                botPlayed: document.getElementById("bot-played"),
                playerZone: document.getElementById("player-zone"),
                botZone: document.getElementById("bot-zone"),
                playerName: document.getElementById("player-name"),
                botName: document.getElementById("bot-name"),
                status: document.getElementById("status"),
                modal: document.getElementById("modal"),
                modalTitle: document.getElementById("modal-title"),
                modalContent: document.getElementById("modal-content"),
                modalButtons: document.getElementById("modal-buttons"),
                historyPanel: document.getElementById("history-panel"),
                historyList: document.getElementById("history-list"),
                historyToggle: document.getElementById("history-toggle"),
                rulesBtn: document.getElementById("rules-btn"),
                difficulty: document.getElementById("difficulty"),
            };

            // ============================================
            // UTILITY FUNCTIONS
            // ============================================
            function delay(ms) {
                return new Promise((resolve) => setTimeout(resolve, ms));
            }

            function createDeck() {
                const deck = [];
                for (const suit in SUITS) {
                    for (const rank of RANKS) {
                        deck.push({ rank, suit });
                    }
                }
                return deck;
            }

            function shuffleDeck(deck) {
                for (let i = deck.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [deck[i], deck[j]] = [deck[j], deck[i]];
                }
                return deck;
            }

            function getEffectiveSuit(card) {
                if (!card || !state.trump) return card?.suit;
                // Left bower belongs to trump suit
                if (
                    card.rank === "J" &&
                    card.suit === SAME_COLOR[state.trump]
                ) {
                    return state.trump;
                }
                return card.suit;
            }

            function getCardPower(card) {
                if (!card) return -1;
                const effSuit = getEffectiveSuit(card);
                const isTrump = effSuit === state.trump;

                if (isTrump) {
                    // Right bower (highest)
                    if (card.rank === "J" && card.suit === state.trump)
                        return 106;
                    // Left bower (second highest)
                    if (
                        card.rank === "J" &&
                        card.suit === SAME_COLOR[state.trump]
                    )
                        return 105;
                    // Other trump cards
                    return 100 + RANK_ORDER[card.rank];
                }

                return RANK_ORDER[card.rank];
            }

            function cardToString(card) {
                return `${card.rank}${SUITS[card.suit]}`;
            }

            // ============================================
            // UI RENDERING
            // ============================================
            function createCardElement(card, id = null) {
                const el = document.createElement("div");

                if (card) {
                    el.className = `card ${SUIT_COLORS[card.suit]}`;
                    el.innerHTML = `
                <span class="card-rank">${card.rank}</span>
                <span class="card-suit">${SUITS[card.suit]}</span>
            `;
                    el.dataset.rank = card.rank;
                    el.dataset.suit = card.suit;
                } else {
                    el.className = "card face-down";
                }

                if (id) el.id = id;
                return el;
            }

            function renderHands() {
                // Clear containers
                els.playerTable.innerHTML = "";
                els.botTable.innerHTML = "";
                els.playerHand.innerHTML = "";
                els.botHand.innerHTML = "";

                // Render table cards (4 slots each)
                for (let i = 0; i < 4; i++) {
                    // Player table slot
                    const pSlot = document.createElement("div");
                    pSlot.className = "table-slot";

                    if (
                        state.playerHand.tableDown[i] ||
                        state.playerHand.tableUp[i]
                    ) {
                        const downCard = createCardElement(null);
                        pSlot.appendChild(downCard);

                        if (state.playerHand.tableUp[i]) {
                            const upCard = createCardElement(
                                state.playerHand.tableUp[i],
                                `p-table-${i}`,
                            );
                            upCard.classList.add("stacked");
                            if (state.playerHand.tableDown[i]) {
                                upCard.classList.add("top");
                            }
                            pSlot.appendChild(upCard);
                        }
                    }
                    els.playerTable.appendChild(pSlot);

                    // Bot table slot
                    const bSlot = document.createElement("div");
                    bSlot.className = "table-slot";

                    if (
                        state.botHand.tableDown[i] ||
                        state.botHand.tableUp[i]
                    ) {
                        const downCard = createCardElement(null);
                        bSlot.appendChild(downCard);

                        if (state.botHand.tableUp[i]) {
                            const upCard = createCardElement(
                                state.botHand.tableUp[i],
                                `b-table-${i}`,
                            );
                            upCard.classList.add("stacked");
                            if (state.botHand.tableDown[i]) {
                                upCard.classList.add("top");
                            }
                            bSlot.appendChild(upCard);
                        }
                    }
                    els.botTable.appendChild(bSlot);
                }

                // Render hand cards
                state.playerHand.inHand.forEach((card, i) => {
                    if (card) {
                        els.playerHand.appendChild(
                            createCardElement(card, `p-hand-${i}`),
                        );
                    }
                });

                // Bot hand shows face-down cards
                const botHandCount = state.botHand.inHand.filter(
                    (c) => c,
                ).length;
                for (let i = 0; i < botHandCount; i++) {
                    els.botHand.appendChild(createCardElement(null));
                }

                updatePlayableCards();
                updateDealerIndicator();
            }

            function updatePlayableCards() {
                document.querySelectorAll(".card.playable").forEach((c) => {
                    c.classList.remove("playable");
                    c.onclick = null;
                });

                if (
                    state.currentTurn !== "player" ||
                    state.gamePhase !== "playing"
                )
                    return;

                const playable = getPlayableCards("player");
                playable.forEach((info) => {
                    const el = document.getElementById(info.id);
                    if (el) {
                        el.classList.add("playable");
                        el.onclick = () => playerPlaysCard(info);
                    }
                });
            }

            function updateDealerIndicator() {
                els.playerName.classList.toggle("dealer", state.isPlayerDealer);
                els.botName.classList.toggle("dealer", !state.isPlayerDealer);

                els.playerName.classList.toggle(
                    "caller",
                    state.trumpCaller === "player",
                );
                els.botName.classList.toggle(
                    "caller",
                    state.trumpCaller === "bot",
                );
            }

            function updateScores() {
                els.playerScore.textContent = state.playerScore;
                els.botScore.textContent = state.botScore;
                els.playerTricks.textContent = state.playerTricks;
                els.botTricks.textContent = state.botTricks;
            }

            function updateTrumpDisplay() {
                if (state.trump) {
                    els.trumpIndicator.textContent = SUITS[state.trump];
                    els.trumpIndicator.className = `trump-suit ${SUIT_COLORS[state.trump]}`;
                } else {
                    els.trumpIndicator.textContent = "—";
                    els.trumpIndicator.className = "trump-suit";
                }
            }

            function setStatus(text, thinking = false) {
                els.status.innerHTML =
                    text +
                    (thinking
                        ? '<span class="thinking"><span></span><span></span><span></span></span>'
                        : "");
            }

            function updateActiveZone() {
                els.playerZone.classList.toggle(
                    "active",
                    state.currentTurn === "player",
                );
                els.botZone.classList.toggle(
                    "active",
                    state.currentTurn === "bot",
                );
            }

            function addToHistory(trick) {
                const item = document.createElement("div");
                item.className = "history-item";
                const pCard = trick.find((t) => t.player === "player")?.card;
                const bCard = trick.find((t) => t.player === "bot")?.card;
                item.innerHTML = `
            You: ${cardToString(pCard)} vs Bot: ${cardToString(bCard)}
            → <span class="winner">${trick.winner === "player" ? "You" : "Bot"} wins</span>
        `;
                els.historyList.insertBefore(item, els.historyList.firstChild);
            }

            // ============================================
            // MODAL SYSTEM
            // ============================================
            function showModal(title, content, buttons) {
                els.modalTitle.textContent = title;
                els.modalContent.innerHTML = content;
                els.modalButtons.innerHTML = "";

                buttons.forEach((btn) => {
                    const el = document.createElement("button");
                    el.textContent = btn.text;
                    el.className = btn.class || "btn btn-primary";
                    if (btn.suit) {
                        el.className = `suit-btn ${btn.suit}`;
                        el.innerHTML = btn.text;
                    }
                    el.onclick = () => {
                        hideModal();
                        btn.action();
                    };
                    els.modalButtons.appendChild(el);
                });

                els.modal.classList.add("visible");
            }

            function hideModal() {
                els.modal.classList.remove("visible");
            }

            function showRules() {
                showModal(
                    "Rules of Two-Handed Euchre",
                    `
            <div class="rules-content">
                <h4>Objective</h4>
                <p>Be the first player to score ${WINNING_SCORE} points.</p>

                <h4>The Deck</h4>
                <p>24 cards: 9, 10, J, Q, K, A in all four suits.</p>

                <h4>Card Rankings</h4>
                <p><strong>Trump suit (highest to lowest):</strong></p>
                <ul>
                    <li><strong>Right Bower:</strong> Jack of trump suit (highest)</li>
                    <li><strong>Left Bower:</strong> Jack of same color as trump</li>
                    <li>A, K, Q, 10, 9 of trump</li>
                </ul>
                <p><strong>Non-trump suits:</strong> A, K, Q, J, 10, 9</p>

                <h4>Dealing</h4>
                <p>Each player receives:</p>
                <ul>
                    <li>4 cards face-down on the table</li>
                    <li>4 cards face-up on top of those</li>
                    <li>4 cards in their hand</li>
                </ul>

                <h4>Choosing Trump</h4>
                <p>Non-dealer chooses trump first or passes. If they pass, the dealer <em>must</em> choose trump.</p>

                <h4>Playing</h4>
                <ul>
                    <li>Play any face-up table card or any card from your hand</li>
                    <li>Must follow the lead suit if possible</li>
                    <li>When a face-up card is played, the card beneath flips up</li>
                    <li>Highest card of lead suit wins, unless trumped</li>
                </ul>

                <h4>Scoring</h4>
                <p>The trump caller must win at least 7 of 12 tricks:</p>
                <ul>
                    <li><strong>Success:</strong> Both players score 1 point per trick won</li>
                    <li><strong>Failure (Euchred):</strong> Opponent scores 12 points</li>
                </ul>
            </div>
        `,
                    [
                        {
                            text: "Got it!",
                            class: "btn btn-primary",
                            action: () => {},
                        },
                    ],
                );
            }

            // ============================================
            // CARD LOGIC
            // ============================================
            function getPlayableCards(player) {
                const hand =
                    player === "player" ? state.playerHand : state.botHand;
                const prefix = player === "player" ? "p" : "b";

                const allCards = [
                    ...hand.inHand.map((c, i) => ({
                        card: c,
                        id: `${prefix}-hand-${i}`,
                        source: "inHand",
                        index: i,
                    })),
                    ...hand.tableUp.map((c, i) => ({
                        card: c,
                        id: `${prefix}-table-${i}`,
                        source: "tableUp",
                        index: i,
                    })),
                ].filter((info) => info.card);

                if (!state.leadCard) return allCards;

                const leadSuit = getEffectiveSuit(state.leadCard);
                const following = allCards.filter(
                    (info) => getEffectiveSuit(info.card) === leadSuit,
                );

                return following.length > 0 ? following : allCards;
            }

            function removeCard(player, source, index) {
                const hand =
                    player === "player" ? state.playerHand : state.botHand;
                const card = hand[source][index];
                hand[source][index] = null;

                // Clean up nulls from inHand array
                if (source === "inHand") {
                    hand.inHand = hand.inHand.filter((c) => c !== null);
                }

                return card;
            }

            function flipTableCards() {
                for (let i = 0; i < 4; i++) {
                    if (
                        !state.playerHand.tableUp[i] &&
                        state.playerHand.tableDown[i]
                    ) {
                        state.playerHand.tableUp[i] =
                            state.playerHand.tableDown[i];
                        state.playerHand.tableDown[i] = null;
                    }
                    if (
                        !state.botHand.tableUp[i] &&
                        state.botHand.tableDown[i]
                    ) {
                        state.botHand.tableUp[i] = state.botHand.tableDown[i];
                        state.botHand.tableDown[i] = null;
                    }
                }
            }

            // ============================================
            // BOT AI
            // ============================================
            function evaluateHandForTrump(suit) {
                const hand = state.botHand;
                const allCards = [...hand.inHand, ...hand.tableUp].filter(
                    (c) => c,
                );
                let strength = 0;
                const leftBowerSuit = SAME_COLOR[suit];

                allCards.forEach((card) => {
                    if (card.suit === suit) {
                        if (card.rank === "J")
                            strength += 10; // Right bower
                        else if (card.rank === "A") strength += 6;
                        else if (card.rank === "K") strength += 4;
                        else if (card.rank === "Q") strength += 3;
                        else if (card.rank === "10") strength += 2;
                        else strength += 1;
                    } else if (
                        card.suit === leftBowerSuit &&
                        card.rank === "J"
                    ) {
                        strength += 8; // Left bower
                    } else if (card.rank === "A") {
                        strength += 2; // Off-suit aces
                    }
                });

                // Count trump cards
                const trumpCount = allCards.filter(
                    (c) =>
                        c.suit === suit ||
                        (c.suit === leftBowerSuit && c.rank === "J"),
                ).length;

                // Bonus for having many trump
                if (trumpCount >= 4) strength += 3;
                if (trumpCount >= 5) strength += 4;

                return strength;
            }

            function botChooseTrump(mustChoose) {
                const evaluations = {};
                for (const suit in SUITS) {
                    evaluations[suit] = evaluateHandForTrump(suit);
                }

                const bestSuit = Object.entries(evaluations).sort(
                    (a, b) => b[1] - a[1],
                )[0];

                let threshold = mustChoose ? 0 : 12;

                // Adjust threshold based on difficulty
                if (state.difficulty === "easy") threshold -= 3;
                else if (state.difficulty === "hard") threshold += 2;

                // Add some randomness for easy mode
                if (state.difficulty === "easy" && Math.random() < 0.2) {
                    threshold -= 5;
                }

                if (bestSuit[1] >= threshold || mustChoose) {
                    return bestSuit[0];
                }
                return null; // Pass
            }

            function botSelectCard() {
                const playable = getPlayableCards("bot");
                if (playable.length === 0) return null;
                if (playable.length === 1) return playable[0];

                const isLeading = !state.leadCard;
                const tricksRemaining =
                    12 - (state.playerTricks + state.botTricks);
                const botNeedsToWin =
                    state.trumpCaller === "bot" ? 7 - state.botTricks : 0;
                const isWinning = state.botTricks > state.playerTricks;

                // Easy mode: more random, sometimes suboptimal
                if (state.difficulty === "easy" && Math.random() < 0.25) {
                    return playable[
                        Math.floor(Math.random() * playable.length)
                    ];
                }

                // Evaluate each card
                const scored = playable.map((info) => {
                    let score = getCardPower(info.card);
                    const effSuit = getEffectiveSuit(info.card);
                    const isTrump = effSuit === state.trump;

                    if (isLeading) {
                        // Leading strategy
                        if (state.difficulty === "hard") {
                            // Aggressive when behind, conservative when ahead
                            if (
                                !isWinning &&
                                botNeedsToWin > tricksRemaining / 2
                            ) {
                                // Need tricks, lead strong
                                score += isTrump ? 20 : 0;
                            } else if (isWinning && tricksRemaining <= 4) {
                                // Ahead late game, play conservatively
                                score = -score;
                            }
                        }

                        // Prefer leading non-trump when possible
                        if (!isTrump) score += 5;

                        // Prefer leading from table cards to expose new cards
                        if (info.source === "tableUp") score += 3;
                    } else {
                        // Following strategy
                        const leadPower = getCardPower(state.leadCard);
                        const canWin =
                            score > leadPower ||
                            (isTrump &&
                                getEffectiveSuit(state.leadCard) !==
                                    state.trump);

                        if (canWin) {
                            // Win with minimum necessary power
                            if (state.difficulty === "hard") {
                                // Play lowest card that wins
                                const winners = playable.filter((p) => {
                                    const pwr = getCardPower(p.card);
                                    const pTrump =
                                        getEffectiveSuit(p.card) ===
                                        state.trump;
                                    return (
                                        pwr > leadPower ||
                                        (pTrump &&
                                            getEffectiveSuit(state.leadCard) !==
                                                state.trump)
                                    );
                                });

                                if (winners.length > 0) {
                                    const lowestWinner = winners.sort(
                                        (a, b) =>
                                            getCardPower(a.card) -
                                            getCardPower(b.card),
                                    )[0];

                                    if (info === lowestWinner) score += 50;
                                }
                            } else {
                                score += 30;
                            }
                        } else {
                            // Can't win - dump lowest card
                            score = -score;
                        }
                    }

                    return { ...info, score };
                });

                // Sort by score and pick best
                scored.sort((a, b) => b.score - a.score);

                // Medium difficulty: occasionally pick 2nd best
                if (
                    state.difficulty === "medium" &&
                    scored.length > 1 &&
                    Math.random() < 0.15
                ) {
                    return scored[1];
                }

                return scored[0];
            }

            // ============================================
            // GAME FLOW
            // ============================================
            async function startGame() {
                state.playerScore = 0;
                state.botScore = 0;
                state.isPlayerDealer = Math.random() < 0.5;
                updateScores();
                await startNewHand();
            }

            async function startNewHand() {
                // Reset hand state
                state.playerTricks = 0;
                state.botTricks = 0;
                state.trump = null;
                state.trumpCaller = null;
                state.leadCard = null;
                state.playedCards = [];
                state.trickHistory = [];
                state.cardsPlayedThisHand = [];
                state.isPlayerDealer = !state.isPlayerDealer;

                // Clear UI
                els.historyList.innerHTML = "";
                els.playerPlayed.className = "card trick-card";
                els.playerPlayed.innerHTML = "";
                els.botPlayed.className = "card trick-card";
                els.botPlayed.innerHTML = "";

                updateScores();
                updateTrumpDisplay();

                // Create and shuffle deck
                state.deck = shuffleDeck(createDeck());

                // Deal cards
                state.playerHand = {
                    inHand: [],
                    tableUp: [null, null, null, null],
                    tableDown: [null, null, null, null],
                };
                state.botHand = {
                    inHand: [],
                    tableUp: [null, null, null, null],
                    tableDown: [null, null, null, null],
                };

                for (let i = 0; i < 4; i++) {
                    state.playerHand.tableDown[i] = state.deck.pop();
                    state.botHand.tableDown[i] = state.deck.pop();
                }
                for (let i = 0; i < 4; i++) {
                    state.playerHand.tableUp[i] = state.deck.pop();
                    state.botHand.tableUp[i] = state.deck.pop();
                }
                for (let i = 0; i < 4; i++) {
                    state.playerHand.inHand.push(state.deck.pop());
                    state.botHand.inHand.push(state.deck.pop());
                }

                renderHands();
                await delay(300);

                // Trump selection
                await trumpSelection();
            }

            async function trumpSelection() {
                state.gamePhase = "trumpSelect";
                const chooserFirst = state.isPlayerDealer ? "bot" : "player";

                if (chooserFirst === "player") {
                    // Player chooses first
                    showModal(
                        "Choose Trump",
                        "<p>You have first choice. Select a trump suit or pass to the dealer.</p>",
                        [
                            {
                                text: "♥",
                                suit: "hearts",
                                action: () => setTrump("H", "player"),
                            },
                            {
                                text: "♦",
                                suit: "diamonds",
                                action: () => setTrump("D", "player"),
                            },
                            {
                                text: "♣",
                                suit: "clubs",
                                action: () => setTrump("C", "player"),
                            },
                            {
                                text: "♠",
                                suit: "spades",
                                action: () => setTrump("S", "player"),
                            },
                            {
                                text: "Pass",
                                class: "btn",
                                action: () => botMustChooseTrump(),
                            },
                        ],
                    );
                } else {
                    // Bot chooses first
                    setStatus("Opponent is deciding on trump", true);
                    await delay(1200);

                    const choice = botChooseTrump(false);
                    if (choice) {
                        setTrump(choice, "bot");
                        showModal(
                            "Trump Called",
                            `<p>Opponent calls <span style="font-size:2rem">${SUITS[choice]}</span> as trump!</p>`,
                            [
                                {
                                    text: "Continue",
                                    class: "btn btn-primary",
                                    action: startPlaying,
                                },
                            ],
                        );
                    } else {
                        setStatus("");
                        showModal(
                            "Opponent Passes",
                            "<p>The opponent passed. You must choose trump.</p>",
                            [
                                {
                                    text: "♥",
                                    suit: "hearts",
                                    action: () => setTrump("H", "player"),
                                },
                                {
                                    text: "♦",
                                    suit: "diamonds",
                                    action: () => setTrump("D", "player"),
                                },
                                {
                                    text: "♣",
                                    suit: "clubs",
                                    action: () => setTrump("C", "player"),
                                },
                                {
                                    text: "♠",
                                    suit: "spades",
                                    action: () => setTrump("S", "player"),
                                },
                            ],
                        );
                    }
                }
            }

            async function botMustChooseTrump() {
                setStatus("Opponent must choose trump", true);
                await delay(1000);

                const choice = botChooseTrump(true);
                setTrump(choice, "bot");

                showModal(
                    "Trump Called",
                    `<p>Opponent calls <span style="font-size:2rem">${SUITS[choice]}</span> as trump!</p>`,
                    [
                        {
                            text: "Continue",
                            class: "btn btn-primary",
                            action: startPlaying,
                        },
                    ],
                );
            }

            function setTrump(suit, caller) {
                state.trump = suit;
                state.trumpCaller = caller;
                updateTrumpDisplay();
                updateDealerIndicator();

                if (caller === "player") {
                    showModal(
                        "Trump Set",
                        `<p>You called <span style="font-size:2rem">${SUITS[suit]}</span> as trump!</p>`,
                        [
                            {
                                text: "Start Playing",
                                class: "btn btn-primary",
                                action: startPlaying,
                            },
                        ],
                    );
                }
            }

            function startPlaying() {
                state.gamePhase = "playing";
                // Non-dealer leads first
                state.currentTurn = state.isPlayerDealer ? "bot" : "player";

                updateActiveZone();
                renderHands();

                if (state.currentTurn === "player") {
                    setStatus("Your turn to lead");
                } else {
                    botTurn();
                }
            }

            async function playerPlaysCard(cardInfo) {
                if (
                    state.currentTurn !== "player" ||
                    state.gamePhase !== "playing"
                )
                    return;

                const card = removeCard(
                    "player",
                    cardInfo.source,
                    cardInfo.index,
                );
                state.playedCards.push({ player: "player", card });
                state.cardsPlayedThisHand.push(card);

                if (!state.leadCard) state.leadCard = card;

                // Show played card
                els.playerPlayed.innerHTML = createCardElement(card).innerHTML;
                els.playerPlayed.className = `card trick-card visible card-enter ${SUIT_COLORS[card.suit]}`;

                renderHands();

                if (state.playedCards.length === 2) {
                    await delay(400);
                    evaluateTrick();
                } else {
                    state.currentTurn = "bot";
                    updateActiveZone();
                    await delay(300);
                    botTurn();
                }
            }

            async function botTurn() {
                setStatus("Opponent is thinking", true);
                await delay(800 + Math.random() * 600);

                const cardInfo = botSelectCard();
                if (!cardInfo) {
                    console.error("Bot has no playable cards!");
                    return;
                }

                const card = removeCard("bot", cardInfo.source, cardInfo.index);
                state.playedCards.push({ player: "bot", card });
                state.cardsPlayedThisHand.push(card);

                if (!state.leadCard) state.leadCard = card;

                // Show played card
                els.botPlayed.innerHTML = createCardElement(card).innerHTML;
                els.botPlayed.className = `card trick-card visible card-enter ${SUIT_COLORS[card.suit]}`;

                renderHands();

                if (state.playedCards.length === 2) {
                    await delay(500);
                    evaluateTrick();
                } else {
                    state.currentTurn = "player";
                    updateActiveZone();
                    setStatus("Your turn");
                    renderHands();
                }
            }

            async function evaluateTrick() {
                state.gamePhase = "trickEval";

                const card1 = state.playedCards[0];
                const card2 = state.playedCards[1];

                const power1 = getCardPower(card1.card);
                const power2 = getCardPower(card2.card);

                // Determine winner
                let winner;
                const eff1 = getEffectiveSuit(card1.card);
                const eff2 = getEffectiveSuit(card2.card);
                const leadSuit = getEffectiveSuit(state.leadCard);

                if (eff2 === state.trump && eff1 !== state.trump) {
                    winner = card2.player;
                } else if (eff1 === state.trump && eff2 !== state.trump) {
                    winner = card1.player;
                } else if (eff2 === leadSuit && eff1 !== leadSuit) {
                    winner = card1.player; // Card1 led, card2 didn't follow suit and didn't trump
                } else if (eff1 === leadSuit && eff2 !== leadSuit) {
                    winner = card1.player;
                } else {
                    winner = power2 > power1 ? card2.player : card1.player;
                }

                // Update trick count
                if (winner === "player") state.playerTricks++;
                else state.botTricks++;

                updateScores();

                // Highlight winner
                const winnerEl =
                    winner === "player" ? els.playerPlayed : els.botPlayed;
                winnerEl.classList.add("winner");

                setStatus(
                    `<span class="highlight">${winner === "player" ? "You" : "Opponent"}</span> won the trick!`,
                );

                // Record history
                const trick = [...state.playedCards];
                trick.winner = winner;
                state.trickHistory.push(trick);
                addToHistory(trick);

                await delay(1200);

                // Clear trick - add exit animation
                els.playerPlayed.classList.add("card-exit");
                els.botPlayed.classList.add("card-exit");

                await delay(400);

                // Fully reset the trick card elements
                els.playerPlayed.className = "card trick-card";
                els.playerPlayed.innerHTML = "";
                els.botPlayed.className = "card trick-card";
                els.botPlayed.innerHTML = "";

                state.leadCard = null;
                state.playedCards = [];

                // Flip exposed cards
                flipTableCards();
                renderHands();

                // Check if hand is over
                if (state.playerTricks + state.botTricks === 12) {
                    await endHand();
                } else {
                    state.gamePhase = "playing";
                    state.currentTurn = winner;
                    updateActiveZone();

                    if (winner === "player") {
                        setStatus("Your lead");
                        renderHands();
                    } else {
                        botTurn();
                    }
                }
            }

            async function endHand() {
                state.gamePhase = "handEnd";

                let message = "";
                const callerWon =
                    (state.trumpCaller === "player" &&
                        state.playerTricks >= 7) ||
                    (state.trumpCaller === "bot" && state.botTricks >= 7);

                if (state.trumpCaller === "player") {
                    if (state.playerTricks >= 7) {
                        state.playerScore += state.playerTricks;
                        state.botScore += state.botTricks;
                        message = `<p>You made your contract!</p>
                    <p>You: +${state.playerTricks} points | Opponent: +${state.botTricks} points</p>`;
                    } else {
                        state.botScore += 12;
                        message = `<p>You were <strong>euchred!</strong></p>
                    <p>Opponent gets <strong>12 points</strong>.</p>`;
                    }
                } else {
                    if (state.botTricks >= 7) {
                        state.botScore += state.botTricks;
                        state.playerScore += state.playerTricks;
                        message = `<p>Opponent made their contract.</p>
                    <p>You: +${state.playerTricks} points | Opponent: +${state.botTricks} points</p>`;
                    } else {
                        state.playerScore += 12;
                        message = `<p>You <strong>euchred</strong> the opponent!</p>
                    <p>You get <strong>12 points</strong>!</p>`;
                    }
                }

                updateScores();

                // Check for game end
                if (
                    state.playerScore >= WINNING_SCORE ||
                    state.botScore >= WINNING_SCORE
                ) {
                    const gameWinner =
                        state.playerScore >= state.botScore
                            ? "You"
                            : "Opponent";
                    showModal(
                        "Game Over!",
                        `<p><strong>${gameWinner}</strong> won the game!</p>
                <p>Final Score: You ${state.playerScore} - ${state.botScore} Opponent</p>`,
                        [
                            {
                                text: "Play Again",
                                class: "btn btn-primary",
                                action: startGame,
                            },
                        ],
                    );
                } else {
                    showModal(
                        "Hand Complete",
                        message +
                            `<p style="margin-top:1rem">Score: You ${state.playerScore} - ${state.botScore} Opponent</p>`,
                        [
                            {
                                text: "Next Hand",
                                class: "btn btn-primary",
                                action: startNewHand,
                            },
                        ],
                    );
                }
            }

            // ============================================
            // EVENT LISTENERS
            // ============================================
            els.rulesBtn.addEventListener("click", showRules);

            els.difficulty.addEventListener("change", (e) => {
                state.difficulty = e.target.value;
            });

            els.historyToggle.addEventListener("click", () => {
                els.historyPanel.classList.toggle("visible");
            });

            // ============================================
            // INITIALIZATION
            // ============================================
            showModal(
                "Two-Handed Euchre",
                `<p>A classic card game of strategy and trumps.</p>
        <p>First to ${WINNING_SCORE} points wins!</p>`,
                [
                    {
                        text: "Start Game",
                        class: "btn btn-primary",
                        action: startGame,
                    },
                ],
            );
        </script>
    </body>
</html>
